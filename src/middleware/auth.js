const { verifyToken } = require('../utils/jwt');const Usuario = require('../models/Usuario');async function authenticate(req, res, next) {  try {    const authHeader = req.headers.authorization;    if (!authHeader) {      return res.status(401).json({        success: false,        message: 'No se proporcion칩 token de autenticaci칩n'      });    }    const parts = authHeader.split(' ');    if (parts.length !== 2 || parts[0] !== 'Bearer') {      return res.status(401).json({        success: false,        message: 'Formato de token inv치lido. Use: Bearer <token>'      });    }    const token = parts[1];    const decoded = verifyToken(token);    const usuarioId = decoded.id_usuario || decoded.id;    const usuario = await Usuario.findByPk(usuarioId);    if (!usuario) {      return res.status(401).json({        success: false,        message: 'Usuario no encontrado'      });    }    if (!usuario.activo) {      return res.status(403).json({        success: false,        message: 'Tu cuenta ha sido desactivada'      });    }    req.usuario = usuario;    next();  } catch (error) {    return res.status(401).json({      success: false,      message: 'Token inv치lido o expirado',      error: error.message    });  }}module.exports = {  authenticate};