class NotificationService {  async enviarNotificacionPedido(pedido) {    try {      const numerosEncargados = this.obtenerNumerosEncargados();      if (!numerosEncargados || numerosEncargados.length === 0) {        console.warn('âš ï¸ No hay nÃºmeros de encargados configurados');        return false;      }      const mensaje = this.formatearMensajePedido(pedido);      const resultados = await Promise.all(        numerosEncargados.map(numero => this.enviarWhatsApp(numero, mensaje))      );      return resultados.some(resultado => resultado === true);    } catch (error) {      console.error('âŒ Error al enviar notificaciÃ³n:', error);      return false;    }  }  obtenerNumerosEncargados() {    const numeros = process.env.WHATSAPP_ENCARGADOS;    if (!numeros) {      return [];    }    return numeros.split(',').map(num => num.trim()).filter(num => num.length > 0);  }  formatearMensajePedido(pedido) {    const productos = Array.isArray(pedido.productos) ? pedido.productos : JSON.parse(pedido.productos || '[]');    let mensaje = `ğŸ”” *NUEVO PEDIDO*\n\n`;    mensaje += `ğŸ“‹ *Pedido:* ${pedido.numeroPedido}\n`;    mensaje += `ğŸ‘¤ *Cliente:* ${pedido.clienteNombre}\n`;    mensaje += `ğŸ“± *WhatsApp:* ${pedido.whatsapp}\n`;    if (pedido.direccion) {      mensaje += `ğŸ“ *DirecciÃ³n:* ${pedido.direccion}\n`;    }    mensaje += `ğŸ“… *Fecha:* ${pedido.fecha} ${pedido.hora || ''}\n`;    mensaje += `ğŸ’° *Total:* $${parseFloat(pedido.total).toFixed(2)}\n`;    mensaje += `ğŸ“¦ *Estado:* ${pedido.estado.toUpperCase()}\n\n`;    mensaje += `*Productos:*\n`;    productos.forEach((producto, index) => {      mensaje += `${index + 1}. ${producto.nombre || producto.producto || 'Producto'}`;      if (producto.cantidad) {        mensaje += ` x${producto.cantidad}`;      }      if (producto.precio) {        mensaje += ` - $${parseFloat(producto.precio || 0).toFixed(2)}`;      }      mensaje += `\n`;    });    if (pedido.notas) {      mensaje += `\nğŸ“ *Notas:* ${pedido.notas}`;    }    return mensaje;  }  async enviarWhatsApp(numero, mensaje) {    try {      console.log(`ğŸ“¤ Enviando WhatsApp a ${numero}:`);      console.log(`â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`);      console.log(mensaje);      console.log(`â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`);      return true;    } catch (error) {      console.error(`âŒ Error al enviar WhatsApp a ${numero}:`, error.message);      return false;    }  }  async enviarConfirmacionCliente(pedido) {    try {      const mensaje = this.formatearMensajeConfirmacion(pedido);      return await this.enviarWhatsApp(pedido.whatsapp, mensaje);    } catch (error) {      console.error('âŒ Error al enviar confirmaciÃ³n al cliente:', error);      return false;    }  }  formatearMensajeConfirmacion(pedido) {    let mensaje = `âœ… *Â¡Pedido Confirmado!*\n\n`;    mensaje += `ğŸ“‹ *Pedido:* ${pedido.numeroPedido}\n`;    mensaje += `ğŸ“… *Fecha:* ${pedido.fecha} ${pedido.hora || ''}\n`;    mensaje += `ğŸ’° *Total:* $${parseFloat(pedido.total).toFixed(2)}\n`;    mensaje += `ğŸ“¦ *Estado:* ${pedido.estado.toUpperCase()}\n\n`;    mensaje += `Gracias por tu pedido. Te mantendremos informado sobre el estado.`;    return mensaje;  }}module.exports = new NotificationService();